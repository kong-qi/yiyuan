<extend name="Layout:index"/>
<block name="add_js">
    <script src="__JS__/jquery.validate.js"></script>
     <script src="__JS__/layer/layer.js"></script>
</block>
<block name="right">

    <div class="right-box">


        <div class="box">
            <div class="box-title">
                {{ :lang($onname,'menu') }}
                <h3 class="pull-right ">
                    <a href="__CONTROLLER__/" class="btn btn-xs btn-success"><span class="fa fa-mail-reply"></span> {{ :lang('返回','handle') }}</a>
                </h3>
            </div>
            <div class="box-content">
                <div class="form-warp">
                    <div class="tab">
                        <ul>
                            <li class="active">{{ $onname }}</li>

                        </ul>
                    </div>
                    <form action="" method="post" id="validate">
                        <input type="hidden" name="id" value="{{ $data.id }}">
                        <div class="tab-box">
                        <table width="100%" border="0" cellpadding="8" cellspacing="0" class="table">
                            <tbody>
                            <tr>
                                <th width="131">名称</th>
                                <th>内容</th>
                            </tr>
                            <tr>
                                <td align="right">名称</td>
                                <td>
                                    <input type="text" name="name" value="{{ $data.name }}" size="80" class="input">
                                </td>
                            </tr>
                            
                            <tr>
                                <td align="right">地址</td>
                                <td>
                                    <input type="text" name="url" value="{{ $data.url }}" size="80" class="input">
                                </td>
                            </tr>
                            <tr>
                                <td align="right">图片</td>
                                <td class="insert_file">
                                    <input type="text" name="picurl" value="{{ $data.picurl }}" size="30" class="input insert_input">
                                    <button type="button" class="btn btn-xs btn-success" \
                                            onclick="upload_file('{{ :U("Admin/Upload/uploadFile",array('type'=>'images')) }}','.insert_file')">
                                    <span class="fa fa-image"></span> 上传文件</button>

                                    <div class="insert_img">
                                        <?php
                                        $pic_type=explode(".",$data['picurl'] );
                                        $pic_ext=$pic_type[1];
                                        $images_array=array(
                                            'jpg','gif','jpeg','png','bmp'
                                        );
                                        ?>
                                        <?php
                                        if(in_array($pic_ext,$images_array))
                                        {
                                        ?>
                                             <img src="{{ :pic_url($data['picurl']) }}" height="120" alt="">
                                        <?php
                                        }else
                                        {
                                            echo ' <img src="'.WEB_URL."/Public/Admin/images/file.png".'" height="120" alt="">';
                                        }
                                        ?>
                                    </div>


                                </td>
                            </tr>
                            <if condition="C('MORE_LANG')">
                            <tr>
                                <td align="right">英文图片</td>
                                <td class="eninsert_file">
                                    <input type="text" name="enpicurl" value="{{ $data.enpicurl }}" size="30" class="input insert_input">
                                    <button type="button" class="btn btn-xs btn-success" \
                                            onclick="upload_file('{{ :U("Admin/Upload/uploadFile",array('type'=>'images')) }}','.eninsert_file')">
                                    <span class="fa fa-image"></span> 上传文件</button>
                                    <div class="insert_img">
                                         <img src="{{ :pic_url($data['enpicurl']) }}" height="120" alt="">
                                    </div>

                                </td>
                            </tr>
                            </if>


                            <tr>
                                <td align="right">广告位置</td>
                                <td>
                                    <select name="position" id="" class="form-control ">
                                            <option value="index" {{ :($data['position']=='index'?"selected='selected'":"") }}>首页位置</option>
                                            <option value="list" {{ :($data['position']=='list'?"selected='selected'":"") }}>列表位置</option>
                                            <option value="show" {{ :($data['position']=='show'?"selected='selected'":"") }}>内容位置</option>
                                             <option value="login" {{ :($data['position']=='login'?"selected='selected'":"") }}>会员注册/登录位置</option>
                                            <if condition="$sdata">


                                                <foreach name="sdata" item="lv_v" key="k">
                                                    <?php
                                                    $space=str_repeat("&nbsp;", $lv_v['depth'] * 4);
                                                    ?>
                                                    <option {{ :($data['position']==$lv_v['id']?"selected='selected'":"") }}  value="{{ $lv_v['id'] }}">{{ $space }}|-{{ $lv_v['name']
                                                        }}
                                                    </option>
                                                    ;
                                                </foreach>
                                            </if>
                                        </select>
                                </td>
                            </tr>
                            </tbody>
                            <tfooter>
                                <tr>
                                    <td></td>
                                    <td >
                                        <input type="submit" value="提交" class="btn">
                                    </td>
                                </tr>
                            </tfooter>
                        </table>
                    </div>
                    </form>
                </div>
            </div>
            <div class="cl"></div>
        </div>



    </div>
</block>
<block name="add_foot_js">
    <script>

        $.validator.setDefaults({
            highlight: function (e) {
                $(e).closest("td").removeClass("has-success").addClass("has-error")
            }, success: function (e) {
                e.closest("td").removeClass("has-error").addClass("has-success")
            }, errorElement: "span", errorPlacement: function (e, r) {
                e.appendTo(r.is(":radio") || r.is(":checkbox") ? r.parent().parent().parent() : r.parent())
            }, errorClass: "error", validClass: "no-error"

        });
        $().ready(function() {
            // validate the comment form when it is submitted
            var e = "<i class='fa fa-times-circle'></i> ";

            // validate signup form on keyup and submit
            $("#validate").validate({
                rules: {
                    name:{
                        required:1
                       
                    },
                    url:{
                        required:1,
                        //url:1
                    }
                 

                },

            });
        });

    </script>
</block>